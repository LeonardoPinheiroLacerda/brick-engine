= GameState Module Reference
:toc: macro
:toc-title: Table of Contents
:icons: font
:source-highlighter: highlight.js

toc::[]

The `GameState` module acts as the central, single source of truth for the game's lifecycle and user preferences. It handles persistence to `LocalStorage` for settings and high scores.

== Centralized Persistence

As defined in the Architectural Patterns, `GameState` is responsible for all `LocalStorage` logic. Other modules (like `xref:GameSound.adoc[GameSound]`) must sync their internal state with this module via the `xref:../interfaces/StateSyncable.adoc[StateSyncable]` interface.

== API Reference

=== `isOn(): boolean`

Checks if the game system is powered up.

**Returns**

`boolean` - `true` if system is on.


'''

=== `isOff(): boolean`

Checks if the game system is powered down.

**Returns**

`boolean` - `true` if system is off.


'''

=== `isStarted(): boolean`

Checks if a game session is active (passed the title screen).

**Returns**

`boolean` - `true` if the game has started.


'''

=== `isPlaying(): boolean`

Checks if the game loop is actively updating logic.

**Returns**

`boolean` - `true` if gameplay is active and not paused.


'''

=== `isPaused(): boolean`

Checks if the game is currently paused.

**Returns**

`boolean` - `true` if the game is started but halted.


'''

=== `isGameOver(): boolean`

Checks if the current session has ended in a Game Over.

**Returns**

`boolean` - `true` if player has lost.


'''

=== `turnOn(): void`

Powers on the game system.

**Behavior**

Sets the `on` property to true and ensures `start`, `playing`, and `gameOver` are initialized to false.


'''

=== `turnOff(): void`

Powers off the game system.

**Behavior**

Sets the `on` property to false and wipes transient state.


'''

=== `startGame(): void`

Initiates gameplay from the title screen.

**Behavior**

Sets `start` and `playing` to true. This method only has effect if the system is already `on`.


'''

=== `exitGame(): void`

Ends the session and returns to the title screen.

**Behavior**

Resets `start`, `playing`, and `gameOver` to false.


'''

=== `pause(): void`

Halts gameplay logic.

**Behavior**

Sets `playing` to false. Only works if the game is already started.


'''

=== `resume(): void`

Restarts gameplay logic from a paused state.

**Behavior**

Sets `playing` to true.


'''

=== `triggerGameOver(): void`

Forces the game into a Game Over state.

**Behavior**

Sets `playing` to false and `gameOver` to true.


'''

=== `resetGame(): void`

Prepares the state for a new round after a Game Over.

**Behavior**

Clears the `gameOver` flag and resumes `playing` status.


'''

=== `isColorEnabled(): boolean`

Checks if theme color mode is active.

**Returns**

`boolean` - `true` if color mode is on.


'''

=== `setColorEnabled(value: boolean): void`

Sets the color mode preference.

**Parameters**

[cols="1,1,3"]
|===
|Name |Type |Description
|`value` |`boolean` |New color mode status.
|===

**Behavior**

Updates the property and automatically persists the value to `LocalStorage`.


'''

=== `toggleColorEnabled(): void`

Toggles the current color mode.


'''

=== `isMuted(): boolean`

Checks if master audio is muted.

**Returns**

`boolean` - `true` if sound is disabled.


'''

=== `setMuted(value: boolean): void`

Sets the master mute status.

**Parameters**

[cols="1,1,3"]
|===
|Name |Type |Description
|`value` |`boolean` |New mute status.
|===

**Behavior**

Updates the property and persists it to `LocalStorage`.


'''

=== `toggleMuted(): void`

Toggles the master mute status.


'''

=== `getHighScore(): number`

Retrieves the highest score recorded.

**Returns**

`number` - The stored high score.


'''

=== `setHighScore(value: number): void`

Updates the high score.

**Parameters**

[cols="1,1,3"]
|===
|Name |Type |Description
|`value` |`number` |The new record score.
|===

**Behavior**

Updates the value and persists it to `LocalStorage`. High scores are prefixed by the game's persistence key.


'''

=== `subscribe(property: StateProperty, callback: (value: boolean | number) => void): void`

Registers a listener for state changes.

**Parameters**

[cols="1,1,3"]
|===
|Name |Type |Description
|`property` |`xref:../enums/StateProperty.adoc[StateProperty]` |The specific property to monitor.
|`callback` |`Function` |The function to execute on change.
|===

**Example**

[source,typescript]
----
state.subscribe(StateProperty.GAME_OVER, (isOver) => {
    if (isOver) {
        this.modules.sound.play(Sound.GAMEOVER);
    }
});
----


'''

=== `unsubscribe(property: StateProperty, callback: (value: boolean | number) => void): void`

Removes a state change listener.

**Parameters**

[cols="1,1,3"]
|===
|Name |Type |Description
|`property` |`xref:../enums/StateProperty.adoc[StateProperty]` |The property being monitored.
|`callback` |`Function` |The reference to the callback to remove.
|===


'''

=== `setPersistenceKey(key: string): void`

Configures the unique identifier for storage.

**Parameters**

[cols="1,1,3"]
|===
|Name |Type |Description
|`key` |`string` |The prefix to use for `LocalStorage` entries.
|===


'''

=== `getPersistenceKey(): string`

Retrieves the currently configured storage key.

**Returns**

`string` - The persistence key.


'''

=== `getDebugData(): Record<string, string | number | boolean>`

Returns metadata for the real-time debugger.
