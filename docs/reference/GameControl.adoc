= GameControl Module
:toc: macro
:toc-title: Table of Contents
:icons: font
:source-highlighter: highlight.js

toc::[]

The `GameControl` module handles user input from keyboard and virtual UI buttons. It provides an event-based system for reacting to player actions.

== Supported Keys (`ControlKey`)

The engine maps physical keys (Arrow keys, WASD, Space, Enter) to virtual keys:

* `UP` / `DOWN` / `LEFT` / `RIGHT`: Directional controls.
* `ACTION`: Primary action (e.g., Spacebar).
* `START_PAUSE`: Pausing or starting game (e.g., Enter/P).
* `RESET`: Reset game.
* `SOUND`: Toggle sound.
* `COLOR`: Toggle color mode.
* `POWER`: Turn console on/off.
* `EXIT`: Exit game (if supported by environment).

== Event Types (`ControlEventType`)

* `ControlEventType.PRESSED` (`'pressed'`): Triggered once when key is pressed.
* `ControlEventType.HELD` (`'held'`): Triggered repeatedly while key is held down (interval defined in config).

[NOTE]
====
System keys like `POWER`, `SOUND`, `RESET`, etc., have their default behaviors automatically handled by the `Game` base class.
====

== API Reference

=== `subscribe(key: ControlKey, type: ControlEventType, callback: ControlCallback): void`

Register a callback for a specific key and event type.

**Parameters**

[cols="1,1,3"]
|===
|Name |Type |Description
|`key` |`ControlKey` |The key to listen for (e.g., `ControlKey.ACTION`).
|`type` |`ControlEventType` |The event type (e.g., `ControlEventType.PRESSED`).
|`callback` |`ControlCallback` |Function to execute when event triggers.
|===


**Behavior**

Adds the callback to the internal list for the specified key and type. Multiple callbacks can be registered for the same event.

**Example**

[source,typescript]
----
control.subscribe(ControlKey.ACTION, ControlEventType.PRESSED, () => {
    this.shoot();
});
----

=== `unsubscribe(key: ControlKey, type: ControlEventType, callback: ControlCallback): void`

Remove a previously registered callback.

**Parameters**

[cols="1,1,3"]
|===
|Name |Type |Description
|`key` |`ControlKey` |The key to listen for.
|`type` |`ControlEventType` |The event type.
|`callback` |`ControlCallback` |The reference to the function to remove.
|===


**Behavior**

Removes the specific callback from the subscription list. Does nothing if the callback is not found.

**Example**

[source,typescript]
----
control.unsubscribe(ControlKey.ACTION, ControlEventType.PRESSED, myCallback);
----

=== `bound(): void`

Bind control event listeners to the window/document.

**Behavior**

Attaches the keyboard event listeners (`keydown`, `keyup`). This is called automatically by `Game.setup()`, but can be called manually if you need to re-attach controls after unbinding.

=== `unbound(): void`

Unbind all control event listeners.

**Behavior**

Removes all keyboard event listeners and clears all subscriptions. This is called automatically by `Game.destroy()`. Use this to temporarily disable all input or clean up before destroying the control module.

=== `notify(key: ControlKey, type: ControlEventType): void`

Manually trigger an event.

**Parameters**

[cols="1,1,3"]
|===
|Name |Type |Description
|`key` |`ControlKey` |The key identifier.
|`type` |`ControlEventType` |The event type (pressed/held).
|===

**Behavior**

Executes all callbacks associated with the key/type pair. Mostly used internally by the input system but can simulate inputs.

=== `getDebugData(): Record<string, string | number | boolean>`

Returns the debug data for the module.

**Returns**

`Record<string, string | number | boolean>` - Object containing `total_subscribers` and `tracked_keys`.


